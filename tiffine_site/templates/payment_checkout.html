{% extends 'base.html' %}

{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/payment_check.css' %}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    
<div class="container mt-4" >
    <div class="row border shadow-sm m-1 p-2 rounded item-check">
        <h4 class="text-success opacity-50"> Item summury </h4> 

        <div class="row">
        {% for cart in dish_instance %}
                <div class="col-sm-12 col-md-4  ">
                    <div class="card mb-2 shadow-sm">
                        <div class="card-body card-color rounded-1 ">
                            <a href="#" class="btn-close get_id float-end" id="del-cart" data-sid="{{cart.id}}"></a>
                            <h5 class="card-title">{{cart.item.name}}</h5>
                            <p class="card-text">{{cart.item.deatil}}</p>
                            <p class=" mb-0 btn btn-warning text-center">&#x20B9; : {{cart.item.discounted}}</p>
                            <!-- <h5 class=" text-dark opacity-50"><small>saved &#x20B9; : 25</small></h5> -->

                            <div class=" d-inline p-2 ">
                                <a href="#" class="minus-"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash" viewBox="0 0 16 16">
                                    <path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"/>
                                    </svg>    
                                </a>
                                <p class=" d-inline" id = "value-q" data-sid ="sid{{cart.id}}">1</p>
                                <a href="#" class="plus"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus-lg" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                                    </svg>
                                </a>
                            </div>

                        </div>
                    </div>
                </div>

                <script>
                     $('.minus-').on('click', function(){
                         console.log('Work tll here')
                        let quan = $('#value-q').html();
                        console.log(quan)
                        quan --;
                        let value = $('#value-q').html(quan);

                    })
                    
                    $('.plus').on('click', function(){
                        let quan = $('#value-q').html();
                        console.log('working', quan)
                        quan ++;
                        let value = $('#value-q').html(quan);

                    })
                </script>
                
            {% empty %}
            <p class="alert alert-warning shadow-sm">Doesn't have any items here !</p>
            {% endfor %}  
        </div>

    </div>

    <div class = "row border shadow m-1 p-1 mt-4 ">
        <div class = "col  bg-info bg-opacity-25">
            <h4 > Payment summury </h4>
            <div class="col p-1">
                <h6>Total Amount : <strong>350</strong></h6>
                <h6>Delivery charges : <strong>Free</strong></h6>
                <h6>Discount : <strong>50</strong></h6>
                <hr>
                <h6>Grand Total : <strong>350</strong></h6>
                <p></p>
                <button class="btn btn-warning " type="button">Pay Online</button>
                <button class="btn btn-success " type="button">Pay Cash</button>
                <p class="d-inline opacity-25  ">* T & C Apply</p>
            </div> 
        </div>
    </div>
</div>
  
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    $('.get_id').on('click', function(){
        let get_id = $(this).attr('data-sid')

        data_obj = {
            dish_id : get_id,
            csrfmiddlewaretoken: '{{ csrf_token }}',
        }

        this_obj = this

        $.ajaxSetup({ headers: { 'csrftoken' : '{{ csrf_token }}' } });
        $.ajax({
            url : "{% url 'Add_to_dabba' %}",
            method : "POST",
            data : data_obj,
            dataType : 'json',
            success : function(data){
                if (data.status == 'delete'){
                    $(this_obj).parent().parent('div').fadeOut()
                }
                if($('.item-check').length == 0){
                    console.log('empty')
                }

            }
        })
    })

   
    
</script>
{% endblock %}
